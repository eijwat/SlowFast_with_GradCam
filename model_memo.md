## モデル構成

Inputのテンソルは`batch` x `channel` x `num frames` x `height` x `width`

```
========================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #
========================================================================================================================
ResNet                                        [1, 16, 3, 8, 224, 224]   [16, 2]                   --
├─VideoModelStem: 1-1                         [1, 16, 3, 8, 224, 224]   [16, 64, 8, 56, 56]       --
│    └─ResNetBasicStem: 2-1                   [16, 3, 8, 224, 224]      [16, 64, 8, 56, 56]       --
│    │    └─Conv3d: 3-1                       [16, 3, 8, 224, 224]      [16, 64, 8, 112, 112]     9,408
│    │    └─BatchNorm3d: 3-2                  [16, 64, 8, 112, 112]     [16, 64, 8, 112, 112]     128
│    │    └─ReLU: 3-3                         [16, 64, 8, 112, 112]     [16, 64, 8, 112, 112]     --
│    │    └─MaxPool3d: 3-4                    [16, 64, 8, 112, 112]     [16, 64, 8, 56, 56]       --
├─ResStage: 1-2                               [16, 64, 8, 56, 56]       [16, 256, 8, 56, 56]      --
│    └─ResBlock: 2-2                          [16, 64, 8, 56, 56]       [16, 256, 8, 56, 56]      --
│    │    └─BottleneckTransform: 3-5          [16, 64, 8, 56, 56]       [16, 256, 8, 56, 56]      58,112
│    │    └─Conv3d: 3-6                       [16, 64, 8, 56, 56]       [16, 256, 8, 56, 56]      16,384
│    │    └─BatchNorm3d: 3-7                  [16, 256, 8, 56, 56]      [16, 256, 8, 56, 56]      512
│    │    └─ReLU: 3-8                         [16, 256, 8, 56, 56]      [16, 256, 8, 56, 56]      --
│    └─ResBlock: 2-3                          [16, 256, 8, 56, 56]      [16, 256, 8, 56, 56]      --
│    │    └─BottleneckTransform: 3-9          [16, 256, 8, 56, 56]      [16, 256, 8, 56, 56]      70,400
│    │    └─ReLU: 3-10                        [16, 256, 8, 56, 56]      [16, 256, 8, 56, 56]      --
│    └─ResBlock: 2-4                          [16, 256, 8, 56, 56]      [16, 256, 8, 56, 56]      --
│    │    └─BottleneckTransform: 3-11         [16, 256, 8, 56, 56]      [16, 256, 8, 56, 56]      70,400
│    │    └─ReLU: 3-12                        [16, 256, 8, 56, 56]      [16, 256, 8, 56, 56]      --
├─MaxPool3d: 1-3                              [16, 256, 8, 56, 56]      [16, 256, 4, 56, 56]      --
├─ResStage: 1-4                               [16, 256, 4, 56, 56]      [16, 512, 4, 28, 28]      --
│    └─ResBlock: 2-5                          [16, 256, 4, 56, 56]      [16, 512, 4, 28, 28]      --
│    │    └─BottleneckTransform: 3-13         [16, 256, 4, 56, 56]      [16, 512, 4, 28, 28]      247,296
│    │    └─Conv3d: 3-14                      [16, 256, 4, 56, 56]      [16, 512, 4, 28, 28]      131,072
│    │    └─BatchNorm3d: 3-15                 [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      1,024
│    │    └─ReLU: 3-16                        [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    └─ResBlock: 2-6                          [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    │    └─BottleneckTransform: 3-17         [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      280,064
│    │    └─ReLU: 3-18                        [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    └─Nonlocal: 2-7                          [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    │    └─Conv3d: 3-19                      [16, 512, 4, 28, 28]      [16, 256, 4, 28, 28]      131,328
│    │    └─MaxPool3d: 3-20                   [16, 512, 4, 28, 28]      [16, 512, 4, 14, 14]      --
│    │    └─Conv3d: 3-21                      [16, 512, 4, 14, 14]      [16, 256, 4, 14, 14]      131,328
│    │    └─Conv3d: 3-22                      [16, 512, 4, 14, 14]      [16, 256, 4, 14, 14]      131,328
│    │    └─Conv3d: 3-23                      [16, 256, 4, 28, 28]      [16, 512, 4, 28, 28]      131,584
│    │    └─BatchNorm3d: 3-24                 [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      1,024
│    └─ResBlock: 2-8                          [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    │    └─BottleneckTransform: 3-25         [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      280,064
│    │    └─ReLU: 3-26                        [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    └─ResBlock: 2-9                          [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    │    └─BottleneckTransform: 3-27         [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      280,064
│    │    └─ReLU: 3-28                        [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    └─Nonlocal: 2-10                         [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      --
│    │    └─Conv3d: 3-29                      [16, 512, 4, 28, 28]      [16, 256, 4, 28, 28]      131,328
│    │    └─MaxPool3d: 3-30                   [16, 512, 4, 28, 28]      [16, 512, 4, 14, 14]      --
│    │    └─Conv3d: 3-31                      [16, 512, 4, 14, 14]      [16, 256, 4, 14, 14]      131,328
│    │    └─Conv3d: 3-32                      [16, 512, 4, 14, 14]      [16, 256, 4, 14, 14]      131,328
│    │    └─Conv3d: 3-33                      [16, 256, 4, 28, 28]      [16, 512, 4, 28, 28]      131,584
│    │    └─BatchNorm3d: 3-34                 [16, 512, 4, 28, 28]      [16, 512, 4, 28, 28]      1,024
├─ResStage: 1-5                               [16, 512, 4, 28, 28]      [16, 1024, 4, 14, 14]     --
│    └─ResBlock: 2-11                         [16, 512, 4, 28, 28]      [16, 1024, 4, 14, 14]     --
│    │    └─BottleneckTransform: 3-35         [16, 512, 4, 28, 28]      [16, 1024, 4, 14, 14]     986,112
│    │    └─Conv3d: 3-36                      [16, 512, 4, 28, 28]      [16, 1024, 4, 14, 14]     524,288
│    │    └─BatchNorm3d: 3-37                 [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     2,048
│    │    └─ReLU: 3-38                        [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    └─ResBlock: 2-12                         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    │    └─BottleneckTransform: 3-39         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     1,117,184
│    │    └─ReLU: 3-40                        [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    └─Nonlocal: 2-13                         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    │    └─Conv3d: 3-41                      [16, 1024, 4, 14, 14]     [16, 512, 4, 14, 14]      524,800
│    │    └─MaxPool3d: 3-42                   [16, 1024, 4, 14, 14]     [16, 1024, 4, 7, 7]       --
│    │    └─Conv3d: 3-43                      [16, 1024, 4, 7, 7]       [16, 512, 4, 7, 7]        524,800
│    │    └─Conv3d: 3-44                      [16, 1024, 4, 7, 7]       [16, 512, 4, 7, 7]        524,800
│    │    └─Conv3d: 3-45                      [16, 512, 4, 14, 14]      [16, 1024, 4, 14, 14]     525,312
│    │    └─BatchNorm3d: 3-46                 [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     2,048
│    └─ResBlock: 2-14                         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    │    └─BottleneckTransform: 3-47         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     1,117,184
│    │    └─ReLU: 3-48                        [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    └─ResBlock: 2-15                         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    │    └─BottleneckTransform: 3-49         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     1,117,184
│    │    └─ReLU: 3-50                        [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    └─Nonlocal: 2-16                         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    │    └─Conv3d: 3-51                      [16, 1024, 4, 14, 14]     [16, 512, 4, 14, 14]      524,800
│    │    └─MaxPool3d: 3-52                   [16, 1024, 4, 14, 14]     [16, 1024, 4, 7, 7]       --
│    │    └─Conv3d: 3-53                      [16, 1024, 4, 7, 7]       [16, 512, 4, 7, 7]        524,800
│    │    └─Conv3d: 3-54                      [16, 1024, 4, 7, 7]       [16, 512, 4, 7, 7]        524,800
│    │    └─Conv3d: 3-55                      [16, 512, 4, 14, 14]      [16, 1024, 4, 14, 14]     525,312
│    │    └─BatchNorm3d: 3-56                 [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     2,048
│    └─ResBlock: 2-17                         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    │    └─BottleneckTransform: 3-57         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     1,117,184
│    │    └─ReLU: 3-58                        [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    └─ResBlock: 2-18                         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    │    └─BottleneckTransform: 3-59         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     1,117,184
│    │    └─ReLU: 3-60                        [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    └─Nonlocal: 2-19                         [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     --
│    │    └─Conv3d: 3-61                      [16, 1024, 4, 14, 14]     [16, 512, 4, 14, 14]      524,800
│    │    └─MaxPool3d: 3-62                   [16, 1024, 4, 14, 14]     [16, 1024, 4, 7, 7]       --
│    │    └─Conv3d: 3-63                      [16, 1024, 4, 7, 7]       [16, 512, 4, 7, 7]        524,800
│    │    └─Conv3d: 3-64                      [16, 1024, 4, 7, 7]       [16, 512, 4, 7, 7]        524,800
│    │    └─Conv3d: 3-65                      [16, 512, 4, 14, 14]      [16, 1024, 4, 14, 14]     525,312
│    │    └─BatchNorm3d: 3-66                 [16, 1024, 4, 14, 14]     [16, 1024, 4, 14, 14]     2,048
├─ResStage: 1-6                               [16, 1024, 4, 14, 14]     [16, 2048, 4, 7, 7]       --
│    └─ResBlock: 2-20                         [16, 1024, 4, 14, 14]     [16, 2048, 4, 7, 7]       --
│    │    └─BottleneckTransform: 3-67         [16, 1024, 4, 14, 14]     [16, 2048, 4, 7, 7]       3,938,304
│    │    └─Conv3d: 3-68                      [16, 1024, 4, 14, 14]     [16, 2048, 4, 7, 7]       2,097,152
│    │    └─BatchNorm3d: 3-69                 [16, 2048, 4, 7, 7]       [16, 2048, 4, 7, 7]       4,096
│    │    └─ReLU: 3-70                        [16, 2048, 4, 7, 7]       [16, 2048, 4, 7, 7]       --
│    └─ResBlock: 2-21                         [16, 2048, 4, 7, 7]       [16, 2048, 4, 7, 7]       --
│    │    └─BottleneckTransform: 3-71         [16, 2048, 4, 7, 7]       [16, 2048, 4, 7, 7]       4,462,592
│    │    └─ReLU: 3-72                        [16, 2048, 4, 7, 7]       [16, 2048, 4, 7, 7]       --
│    └─ResBlock: 2-22                         [16, 2048, 4, 7, 7]       [16, 2048, 4, 7, 7]       --
│    │    └─BottleneckTransform: 3-73         [16, 2048, 4, 7, 7]       [16, 2048, 4, 7, 7]       4,462,592
│    │    └─ReLU: 3-74                        [16, 2048, 4, 7, 7]       [16, 2048, 4, 7, 7]       --
├─ResNetBasicHead: 1-7                        [16, 2048, 4, 7, 7]       [16, 2]                   --
│    └─AvgPool3d: 2-23                        [16, 2048, 4, 7, 7]       [16, 2048, 1, 1, 1]       --
│    └─Dropout: 2-24                          [16, 1, 1, 1, 2048]       [16, 1, 1, 1, 2048]       --
│    └─Linear: 2-25                           [16, 1, 1, 1, 2048]       [16, 1, 1, 1, 2]          4,098
│    └─Softmax: 2-26                          [16, 1, 1, 1, 2]          [16, 1, 1, 1, 2]          --
```

## 3D GradCam

3DCNNに対するGradCam実装

以下の2つは空間的な3次元データである医療画像でGradCamを拡張した例。
動画のような時間に対する3次元データに対しても応用可能と思われる。

* https://github.com/west-gates/3DCNN-Vis
* https://github.com/fitushar/3D-Grad-CAM
